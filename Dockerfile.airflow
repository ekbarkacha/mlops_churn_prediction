# Shared base image
FROM ml-base:latest

WORKDIR /opt/airflow
ENV AIRFLOW_HOME=/opt/airflow/airflow

# Copy scripts and DAGs
COPY scripts/ ./scripts/
COPY airflow/dags/ ./airflow/dags/

# Make scripts executable
RUN chmod +x ./scripts/*.sh

# Expose the webserver port
EXPOSE 8080

# Run entrypoint
ENTRYPOINT ["bash", "/opt/airflow/scripts/entrypoint.sh"]